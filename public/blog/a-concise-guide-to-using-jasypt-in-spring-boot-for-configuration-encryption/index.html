<!DOCTYPE html>
<html lang="en-US" class="scroll-smooth dark">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>

<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>A Concise Guide to Using Jasypt In Spring Boot for Configuration Encryption</title>
<meta
  name="description"
  content="Jasypt is a simple encryption library. You can use it to encrypt anything, but one good use case is just encrypting your application configuration directly in your config file, so that if someone obtained access to your source control directory or had a copy of your source code, they would not also have access to any of your secrets."
/>
<link rel="canonical" href="http://localhost:1313/blog/a-concise-guide-to-using-jasypt-in-spring-boot-for-configuration-encryption/" />
<link rel="robots" href="/robots.txt" />

<link rel="icon" type="image/x-icon" href="/img/nficon.png" />



<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script>

<link rel="stylesheet" href="http://localhost:1313/css/app.css" /></head>

  <body class="max-w-screen-md mx-auto px-2.5">
    <div class="header">
      <header class="flex flex-col sm:flex-row items-center gap-5 sm:gap-10 pt-16 py-12">
   


<div class="flex-none w-20 h-20 rounded-full overflow-hidden">
  <a href="http://localhost:1313/">
    <img
      srcset="/img/profile-picture_hu4241499301404582006.jpg 80w"
      src="/img/profile-picture.jpg"
      width="386"
      height="345"
      alt="Nick Fisher&#39;s tech blog"
    />
  </a>
</div>

  
  <div class="flex flex-col gap-5">
    <a href="http://localhost:1313/">
  <h1 id="site-title">Nick Fisher&#39;s tech blog</h1>
</a>
 
    <nav>
  <ul>
     
    
    <li>
      <a href="/" class="">
        home
      </a>
    </li>
    
    <li>
      <a href="/blog" class="">
        blog
      </a>
    </li>
    
    <li>
      <a href="/about" class="">
        about
      </a>
    </li>
    
    <li>
      <a href="/tags" class="">
        Tags
      </a>
    </li>
    
  </ul>
</nav>

  </div>
</header>

      <button class="toggle-theme" aria-label="Toggle Theme" title="Toggle Theme" onclick="toggleTheme()">
  <span class="theme-icon light"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
</svg> </span>
  <span class="theme-icon dark"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" />
</svg> </span>
</button>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const theme = localStorage.getItem('theme');

    if (!theme || theme === 'light') {
      setTheme('light');
    } else {
      setTheme(theme);
    }
  });

  function setTheme(theme) {
    const html = document.querySelector('html');
    localStorage.setItem('theme', theme);

    if (theme === 'light') {
      if (html.classList.contains('dark')) {
        document.querySelector('html').classList.remove('dark');
      }

      document.querySelector('.theme-icon.light').style.display = 'none';
      document.querySelector('.theme-icon.dark').style.display = 'block';
    } else {
      if (!html.classList.contains('dark')) {
        document.querySelector('html').classList.add('dark');
      }

      document.querySelector('.theme-icon.dark').style.display = 'none';
      document.querySelector('.theme-icon.light').style.display = 'block';
    }
  }

  function toggleTheme() {
    const theme = localStorage.getItem('theme');

    if (theme === 'light') {
      setTheme('dark');
    } else {
      setTheme('light');
    }
  }
</script>
    </div>
  
    <main id="content">

<article class="flex flex-col gap-10">
  <header class="flex flex-col gap-2">
    <h2 class="title-large">A Concise Guide to Using Jasypt In Spring Boot for Configuration Encryption</h2>

    <div class="meta">
      
      <time datetime="2020-05-23 01:58:12 &#43;0000 UTC" title='Sat, May 23, 2020, 1:58 AM UTC'>
        23/05/2020 - Estimated reading time: 3 minutes
      </time>

       
      
    </div>
  </header>

  

  <section><p><a href="http://www.jasypt.org/">Jasypt</a> is a simple encryption library. You can use it to encrypt anything, but one good use case is just encrypting your application configuration directly in your config file, so that if someone obtained access to your source control directory or had a copy of your source code, they would not also have access to any of your secrets.</p>
<p>Spring boot is&hellip;you know what spring boot is, let&rsquo;s get started.</p>
<h3 id="encrypting-the-secret-via-the-cli">Encrypting the secret via the CLI</h3>
<p>You can <a href="https://github.com/jasypt/jasypt">download the jasypt CLI zip file</a> directly from github (you&rsquo;ll need java, but I know you already have that because you&rsquo;re writing a spring boot application), and run:</p>
<pre tabindex="0"><code>unzip jasypt-&lt;version&gt;-dist.zip
cd jasypt*
chmod +x bin/*
./bin/encrypt.sh input=&lt;thing-you-want-to-decrypt&gt; password=&lt;your-password&gt;
</code></pre><p>For example, I have a secret database password called <strong>immapanda123</strong> and I have a password named <strong>youcantguessme</strong>:</p>
<pre tabindex="0"><code>./bin/encrypt.sh input=immapanda123 password=youcantguessme
</code></pre><p>What it outputs is non deterministic, if you run it over and over again you&rsquo;ll get a different string. Here&rsquo;s one that it generated for me:</p>
<pre tabindex="0"><code>2WCwqzn+ClzAP44UFAxiHYcKxJ9uiJQU
</code></pre><p><strong>Important note</strong>: the CLI is using the default algorithm of:</p>
<pre tabindex="0"><code>PBEWithMD5AndDES
</code></pre><p>And a default <a href="https://en.wikipedia.org/wiki/Initialization_vector">IV generator</a> of:</p>
<pre tabindex="0"><code>org.jasypt.iv.NoIvGenerator
</code></pre><p>The newest integration between jasypt and spring boot means that these defaults do not align, see the <a href="https://github.com/ulisesbocchio/jasypt-spring-boot#update-11242019-version-300-release-includes">github notes on the 3.xx release</a>. I&rsquo;ll show you how to deal with that in just a bit.</p>
<h3 id="using-the-secret-in-a-spring-boot-application">Using the secret in a spring boot application</h3>
<p>Continuing with the above example&hellip;</p>
<p>Start by pulling down a spring boot project, e.g. the spring initializer. Then add this dependency:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;groupId&gt;</span>com.github.ulisesbocchio<span style="color:#ff79c6">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;artifactId&gt;</span>jasypt-spring-boot-starter<span style="color:#ff79c6">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">&lt;version&gt;</span>3.0.2<span style="color:#ff79c6">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">&lt;/dependency&gt;</span>
</span></span></code></pre></div><p>Set up a configuration class called <strong>AppConfig</strong> like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@Component
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">AppConfig</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Value(<span style="color:#f1fa8c">&#34;${my.secret}&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> String mySecret;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> String <span style="color:#50fa7b">getMySecret</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> mySecret;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">setMySecret</span>(String mySecret) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span>.<span style="color:#50fa7b">mySecret</span> <span style="color:#ff79c6">=</span> mySecret;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And a controller like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@RestController
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">MyController</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd;font-style:italic">final</span> AppConfig config;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#50fa7b">MyController</span>(AppConfig config) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span>.<span style="color:#50fa7b">config</span> <span style="color:#ff79c6">=</span> config;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @GetMapping(<span style="color:#f1fa8c">&#34;/secret&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> ResponseEntity <span style="color:#50fa7b">getSecret</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> ResponseEntity.<span style="color:#50fa7b">ok</span>(config.<span style="color:#50fa7b">getMySecret</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Don&rsquo;t forget to add the <strong>@EnableEncryptableProperties</strong> annotation:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@SpringBootApplication
</span></span><span style="display:flex;"><span>@EnableEncryptableProperties
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">JasyptExampleApplication</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">main</span>(String<span style="color:#ff79c6">[]</span> args) {
</span></span><span style="display:flex;"><span>        SpringApplication.<span style="color:#50fa7b">run</span>(JasyptExampleApplication.<span style="color:#50fa7b">class</span>, args);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>To use the password we just generated, your <strong>application.yml</strong> will have to look like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">jasypt</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">encryptor</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">password</span>: youcantguessme
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">algorithm</span>: PBEWithMD5AndDES
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">iv-generator-classname</span>: org.jasypt.iv.NoIvGenerator
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">my.secret</span>: ENC(2WCwqzn+ClzAP44UFAxiHYcKxJ9uiJQU)
</span></span></code></pre></div><p>You can start up your application and</p>
<pre tabindex="0"><code>$ curl localhost:8080/secret
immapanda123
</code></pre><h3 id="encrypting-with-new-defaults">Encrypting with New Defaults</h3>
<p>In the latest version of spring boot and the jasypt starter 3.xx, the default algorithm is:</p>
<pre tabindex="0"><code>PBEWITHHMACSHA512ANDAES_256
</code></pre><p>This type of encryption does not work without a legit IV generator, and the jasypt cli by default does not use an iv generator. The spring boot default is:</p>
<pre tabindex="0"><code>org.jasypt.iv.RandomIvGenerator
</code></pre><p>So to use the CLI to generate an out-of-the-box compatible password you&rsquo;ll have to encrypt it like:</p>
<pre tabindex="0"><code>./encrypt.sh input=immapanda123 password=youcantguessme algorithm=PBEWITHHMACSHA512ANDAES_256 ivGeneratorClassName=org.jasypt.iv.RandomIvGenerator
</code></pre><p>This is also non deterministic, here&rsquo;s one output I got:</p>
<pre tabindex="0"><code>HU+pHQRhFmvgZ0p+AK1zMHP0ayzyu3liyGLbHvzNy1Lu6gkI+xapltrdescWNdAv
</code></pre><p>Your <strong>application.yml</strong> can now drop the <em>algorithm</em> and <em>iv-generator-classname</em> in the distinction:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">jasypt</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#ff79c6">encryptor</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">password</span>: youcantguessme
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">my.secret</span>: ENC(yVwuQNWRUgy7guzYcfdew3j4zyjTK4WB6MdJuiMZFfe0NRGD/ziX+p73ORWNze3I)
</span></span></code></pre></div><p>And your application should start up and serve the secret at <strong>localhost:8080/secret.</strong></p>
<h3 id="actually-securing-your-app">Actually Securing your App</h3>
<p>There&rsquo;s no point in including the password that you used to encrypt your secrets in plaintext right next to your secret. In reality, you&rsquo;d have different <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-profiles">spring profiles</a> with a different encryption password for each profile. Then you would override the encryptor password with an environment variable at runtime, on whatever server this thing runs on. For example, change your <strong>application.yml</strong> to look like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#ff79c6">my.secret</span>: ENC(yVwuQNWRUgy7guzYcfdew3j4zyjTK4WB6MdJuiMZFfe0NRGD/ziX+p73ORWNze3I)
</span></span></code></pre></div><p>If you start up your app now with no changes you should see this error:</p>
<pre tabindex="0"><code>org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;appConfig&#39;: Injection of autowired dependencies failed;
nested exception is java.lang.IllegalStateException: either &#39;jasypt.encryptor.password&#39; or one of
[&#39;jasypt.encryptor.private-key-string&#39;, &#39;jasypt.encryptor.private-key-location&#39;] must be provided for Password-based or Asymmetric encryption
</code></pre><p>You can provide one using environment variables. Start up your application from the command line like:</p>
<pre tabindex="0"><code>$ export JASYPT_ENCRYPTOR_PASSWORD=youcantguessme
$ java -jar target/*.jar
</code></pre><p>And your application should come up nice and fine.</p>
</section>

  
    
  

    
  


  <footer>
    
      <div class="pb-14 taxonomy-list tags-list">
      
        <a href="/tags/java/" alt="Java">
          Java
        </a>
      
        <a href="/tags/security/" alt="Security">
          Security
        </a>
      
      </div>
    
  </footer>
</article>


    </main><footer class="pt-5 pb-10 grid gap-3 sm:grid-cols-2">
    <div class="text-xs font-semibold text-gray-500 order-2 sm:order-1">
  © 2018-2025 —
  <a href="http://localhost:1313/">Nick Fisher&#39;s tech blog</a> 
</div>

    <div class="order-1 sm:order-2">
  <ul class="flex sm:justify-end gap-5">
    
    
    <li>    
      <a href="https://www.linkedin.com/in/nick-fisher-software/" target="_blank" rel="noopener noreferrer">LinkedIn</a>
    </li>
    
    <li>    
      <a href="https://github.com/nfisher23" target="_blank" rel="noopener noreferrer">GitHub</a>
    </li>
    
    
  </ul>
</div>

</footer></body>
</html>
