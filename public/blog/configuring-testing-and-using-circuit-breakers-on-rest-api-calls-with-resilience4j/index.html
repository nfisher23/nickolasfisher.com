<!DOCTYPE html>
<html lang="en-US" class="scroll-smooth dark">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>

<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Configuring, Testing, and Using Circuit Breakers on Rest API calls with Resilience4j</title>
<meta
  name="description"
  content="The source code for what follows can be found on Github.
The circuit breaker pattern, popularized by Netflix [using Hystrix], exists for a couple of reasons, the most prominent being that it reduces load on a downstream service when it is not responding properly [presumably because it&#39;s under duress]. By wrapping operations that might fail and get overloaded in a circuit breaker, we can prematurely prevent cascading failure and stop overloading those services."
/>
<link rel="canonical" href="http://localhost:1313/blog/configuring-testing-and-using-circuit-breakers-on-rest-api-calls-with-resilience4j/" />
<link rel="robots" href="/robots.txt" />

<link rel="icon" type="image/x-icon" href="/icons/favicon.ico" />



<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script>

<link rel="stylesheet" href="http://localhost:1313/css/app.css" /></head>

  <body class="max-w-screen-md mx-auto px-2.5">
    <div class="header">
      <header class="flex flex-col sm:flex-row items-center gap-5 sm:gap-10 pt-16 py-12">
   


<div class="flex-none w-20 h-20 rounded-full overflow-hidden">
  <a href="http://localhost:1313/">
    <img
      srcset="/img/profile-picture_hu4241499301404582006.jpg 80w"
      src="/img/profile-picture.jpg"
      width="386"
      height="345"
      alt="Nick Fisher&#39;s tech blog"
    />
  </a>
</div>

  
  <div class="flex flex-col gap-5">
    <a href="http://localhost:1313/">
  <h1 id="site-title">Nick Fisher&#39;s tech blog</h1>
</a>
 
    <nav>
  <ul>
     
    
    <li>
      <a href="/" class="">
        home
      </a>
    </li>
    
    <li>
      <a href="/blog" class="">
        blog
      </a>
    </li>
    
    <li>
      <a href="/about" class="">
        about
      </a>
    </li>
    
    <li>
      <a href="/tags" class="">
        Tags
      </a>
    </li>
    
  </ul>
</nav>

  </div>
</header>

      <button class="toggle-theme" aria-label="Toggle Theme" title="Toggle Theme" onclick="toggleTheme()">
  <span class="theme-icon light"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
</svg> </span>
  <span class="theme-icon dark"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" />
</svg> </span>
</button>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const theme = localStorage.getItem('theme');

    if (!theme || theme === 'light') {
      setTheme('light');
    } else {
      setTheme(theme);
    }
  });

  function setTheme(theme) {
    const html = document.querySelector('html');
    localStorage.setItem('theme', theme);

    if (theme === 'light') {
      if (html.classList.contains('dark')) {
        document.querySelector('html').classList.remove('dark');
      }

      document.querySelector('.theme-icon.light').style.display = 'none';
      document.querySelector('.theme-icon.dark').style.display = 'block';
    } else {
      if (!html.classList.contains('dark')) {
        document.querySelector('html').classList.add('dark');
      }

      document.querySelector('.theme-icon.dark').style.display = 'none';
      document.querySelector('.theme-icon.light').style.display = 'block';
    }
  }

  function toggleTheme() {
    const theme = localStorage.getItem('theme');

    if (theme === 'light') {
      setTheme('dark');
    } else {
      setTheme('light');
    }
  }
</script>
    </div>
  
    <main id="content">

<article class="flex flex-col gap-10">
  <header class="flex flex-col gap-2">
    <h2 class="title-large">Configuring, Testing, and Using Circuit Breakers on Rest API calls with Resilience4j</h2>

    <div class="meta">
      
      <time datetime="2021-05-01 19:06:23 &#43;0000 UTC" title='Sat, May 1, 2021, 7:06 PM UTC'>
        01/05/2021 - Estimated reading time: 4 minutes
      </time>

       
      
    </div>
  </header>

  

  <section><p>The source code for what follows <a href="https://github.com/nfisher23/java-failure-and-resilience">can be found on Github</a>.</p>
<p>The circuit breaker pattern, popularized by Netflix [using Hystrix], exists for a couple of reasons, the most prominent being that it reduces load on a downstream service when it is not responding properly [presumably because it's under duress]. By wrapping operations that might fail and get overloaded in a circuit breaker, we can prematurely prevent cascading failure and stop overloading those services.</p>
<h3 id="testing-the-circuit-breaker">Testing the Circuit Breaker</h3>
<p>To start with, we will want to build off of a previous article that demonstrates how to <a href="https://nickolasfisher.com/blog/How-to-Test-Latency-with-a-Mock-Server-in-Java">setup a Mock Server instance for testing</a>. If you're using JUnit5, we can start like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@ExtendWith(MockServerExtension.<span style="color:#50fa7b">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">CircuitBreakerTest</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> ClientAndServer clientAndServer;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> RestTemplate restTemplate;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#50fa7b">CircuitBreakerTest</span>(ClientAndServer clientAndServer) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span>.<span style="color:#50fa7b">clientAndServer</span> <span style="color:#ff79c6">=</span> clientAndServer;
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span>.<span style="color:#50fa7b">restTemplate</span> <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> RestTemplateBuilder()
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">rootUri</span>(<span style="color:#ff79c6">&amp;</span>#34;http:<span style="color:#6272a4">//localhost:&amp;#34; &amp;#43; clientAndServer.getPort())</span>
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">build</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @AfterEach
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">reset</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span>.<span style="color:#50fa7b">clientAndServer</span>.<span style="color:#50fa7b">reset</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>We can now get some more boilerplate out of the way: let's just respond with a 500 status code on every request that we're about to make:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    @Test
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">basicConfig_nothingHappensIfSlidingWindowNotFilled</span>() {
</span></span><span style="display:flex;"><span>        HttpRequest expectedFirstRequest <span style="color:#ff79c6">=</span> HttpRequest.<span style="color:#50fa7b">request</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">withMethod</span>(HttpMethod.<span style="color:#50fa7b">GET</span>.<span style="color:#50fa7b">name</span>())
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">withPath</span>(<span style="color:#ff79c6">&amp;</span>#34;<span style="color:#ff79c6">/</span>some<span style="color:#ff79c6">/</span>endpoint<span style="color:#ff79c6">/</span>10<span style="color:#ff79c6">&amp;</span>#34;);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span>.<span style="color:#50fa7b">clientAndServer</span>
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">when</span>(expectedFirstRequest)
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">respond</span>(HttpResponse.<span style="color:#50fa7b">response</span>().<span style="color:#50fa7b">withStatusCode</span>(500));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ...<span style="color:#50fa7b">code</span> to come...
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>And with that, we can actually start using the circuit breaker to make our applications better at handling failure.</p>
<h3 id="configuring-and-using-the-circuit-breaker">Configuring and Using the Circuit Breaker</h3>
<p>The <a href="https://resilience4j.readme.io/docs/circuitbreaker">circuit breaker configuration options</a> are pretty varied and deserve their own set of articles. In most situations, the defaults are going to be reasonable. One that would make testing this very hard is the <strong>slidingWindowSize</strong>. Because this is set to 100 by default, we would have to call this 100 times before the circuit is eligible to be tripped [OPEN]. Therefore I'm going to make it 10 instead:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>        CircuitBreakerConfig circuitBreakerConfig <span style="color:#ff79c6">=</span> CircuitBreakerConfig
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">custom</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">slidingWindowSize</span>(10)
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">build</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        CircuitBreakerRegistry circuitBreakerRegistry <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>                CircuitBreakerRegistry.<span style="color:#50fa7b">of</span>(circuitBreakerConfig);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        CircuitBreaker callingEndpointCircuitBreaker <span style="color:#ff79c6">=</span> circuitBreakerRegistry.<span style="color:#50fa7b">circuitBreaker</span>(<span style="color:#ff79c6">&amp;</span>#34;call<span style="color:#ff79c6">-</span>endpoint<span style="color:#ff79c6">&amp;</span>#34;);
</span></span></code></pre></div><p>As is a common theme among Resilience4j's tooling, you need a registry, which takes in configuration. Then, to actually get an object you can work with you simply pull from the registry using a string to identify the name.</p>
<p>We can use a circuit breaker by passing in a lambda function containing the code we actually want to run, so that the circuit breaker is decorating it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>                callingEndpointCircuitBreaker.<span style="color:#50fa7b">decorateSupplier</span>(() <span style="color:#ff79c6">-&amp;</span>gt;
</span></span><span style="display:flex;"><span>                        restTemplate.<span style="color:#50fa7b">getForEntity</span>(<span style="color:#ff79c6">&amp;</span>#34;<span style="color:#ff79c6">/</span>some<span style="color:#ff79c6">/</span>endpoint<span style="color:#ff79c6">/</span>10<span style="color:#ff79c6">&amp;</span>#34;, JsonNode.<span style="color:#50fa7b">class</span>)
</span></span><span style="display:flex;"><span>                ).<span style="color:#50fa7b">get</span>();
</span></span></code></pre></div><p>But this doesn't tell us anything about the circuit breaker itself, because as we have it configured this call is just going to fail and we're going to get an exception. We can verify that a circuit trips once the slidingWindowSize has been reached [configured to 10] and then there is a greater than 50% error rate for the underlying operation, which in this case is a network call:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>        <span style="color:#6272a4">// force the circuit to trip</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> 1; i <span style="color:#ff79c6">&amp;</span>lt; 11; i<span style="color:#ff79c6">&amp;</span>#43;<span style="color:#ff79c6">&amp;</span>#43;) {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>                callingEndpointCircuitBreaker.<span style="color:#50fa7b">decorateSupplier</span>(() <span style="color:#ff79c6">-&amp;</span>gt;
</span></span><span style="display:flex;"><span>                        restTemplate.<span style="color:#50fa7b">getForEntity</span>(<span style="color:#ff79c6">&amp;</span>#34;<span style="color:#ff79c6">/</span>some<span style="color:#ff79c6">/</span>endpoint<span style="color:#ff79c6">/</span>10<span style="color:#ff79c6">&amp;</span>#34;, JsonNode.<span style="color:#50fa7b">class</span>)
</span></span><span style="display:flex;"><span>                ).<span style="color:#50fa7b">get</span>();
</span></span><span style="display:flex;"><span>                fail(<span style="color:#ff79c6">&amp;</span>#34;we should never get here<span style="color:#ff79c6">!&amp;</span>#34;);
</span></span><span style="display:flex;"><span>            } <span style="color:#ff79c6">catch</span> (HttpServerErrorException e) {
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">// expected</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// circuit is now tripped</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>            callingEndpointCircuitBreaker.<span style="color:#50fa7b">decorateSupplier</span>(() <span style="color:#ff79c6">-&amp;</span>gt;
</span></span><span style="display:flex;"><span>                    restTemplate.<span style="color:#50fa7b">getForEntity</span>(<span style="color:#ff79c6">&amp;</span>#34;<span style="color:#ff79c6">/</span>some<span style="color:#ff79c6">/</span>endpoint<span style="color:#ff79c6">/</span>10<span style="color:#ff79c6">&amp;</span>#34;, JsonNode.<span style="color:#50fa7b">class</span>)
</span></span><span style="display:flex;"><span>            ).<span style="color:#50fa7b">get</span>();
</span></span><span style="display:flex;"><span>            fail(<span style="color:#ff79c6">&amp;</span>#34;we should never get here<span style="color:#ff79c6">!&amp;</span>#34;);
</span></span><span style="display:flex;"><span>        } <span style="color:#ff79c6">catch</span> (CallNotPermittedException callNotPermittedException)  {
</span></span><span style="display:flex;"><span>            assertEquals(<span style="color:#ff79c6">&amp;</span>#34;call<span style="color:#ff79c6">-</span>endpoint<span style="color:#ff79c6">&amp;</span>#34;, callNotPermittedException.<span style="color:#50fa7b">getCausingCircuitBreakerName</span>());
</span></span><span style="display:flex;"><span>            assertSame(CircuitBreaker.<span style="color:#50fa7b">State</span>.<span style="color:#50fa7b">OPEN</span>, callingEndpointCircuitBreaker.<span style="color:#50fa7b">getState</span>());
</span></span><span style="display:flex;"><span>        }
</span></span></code></pre></div><p>Here we use the circuit breaker decorator to call our downstream service [using mock server to simulate the service]. After ten attempts, because the error percentage was over 50%, we should see a new kind of error&ndash;one generated by the <strong>CircuitBreaker</strong> itself and not by the underlying code that it is decorating.</p>
<p>To sum this up, the code for the entire test can be seen here:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    @Test
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">basicConfig_nothingHappensIfSlidingWindowNotFilled</span>() {
</span></span><span style="display:flex;"><span>        HttpRequest expectedFirstRequest <span style="color:#ff79c6">=</span> HttpRequest.<span style="color:#50fa7b">request</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">withMethod</span>(HttpMethod.<span style="color:#50fa7b">GET</span>.<span style="color:#50fa7b">name</span>())
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">withPath</span>(<span style="color:#ff79c6">&amp;</span>#34;<span style="color:#ff79c6">/</span>some<span style="color:#ff79c6">/</span>endpoint<span style="color:#ff79c6">/</span>10<span style="color:#ff79c6">&amp;</span>#34;);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span>.<span style="color:#50fa7b">clientAndServer</span>
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">when</span>(expectedFirstRequest)
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">respond</span>(HttpResponse.<span style="color:#50fa7b">response</span>().<span style="color:#50fa7b">withStatusCode</span>(500));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        CircuitBreakerConfig circuitBreakerConfig <span style="color:#ff79c6">=</span> CircuitBreakerConfig
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">custom</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">slidingWindowSize</span>(10)
</span></span><span style="display:flex;"><span>                .<span style="color:#50fa7b">build</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        CircuitBreakerRegistry circuitBreakerRegistry <span style="color:#ff79c6">=</span>
</span></span><span style="display:flex;"><span>                CircuitBreakerRegistry.<span style="color:#50fa7b">of</span>(circuitBreakerConfig);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        CircuitBreaker callingEndpointCircuitBreaker <span style="color:#ff79c6">=</span> circuitBreakerRegistry.<span style="color:#50fa7b">circuitBreaker</span>(<span style="color:#ff79c6">&amp;</span>#34;call<span style="color:#ff79c6">-</span>endpoint<span style="color:#ff79c6">&amp;</span>#34;);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// force the circuit to trip</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> 1; i <span style="color:#ff79c6">&amp;</span>lt; 11; i<span style="color:#ff79c6">&amp;</span>#43;<span style="color:#ff79c6">&amp;</span>#43;) {
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>                callingEndpointCircuitBreaker.<span style="color:#50fa7b">decorateSupplier</span>(() <span style="color:#ff79c6">-&amp;</span>gt;
</span></span><span style="display:flex;"><span>                        restTemplate.<span style="color:#50fa7b">getForEntity</span>(<span style="color:#ff79c6">&amp;</span>#34;<span style="color:#ff79c6">/</span>some<span style="color:#ff79c6">/</span>endpoint<span style="color:#ff79c6">/</span>10<span style="color:#ff79c6">&amp;</span>#34;, JsonNode.<span style="color:#50fa7b">class</span>)
</span></span><span style="display:flex;"><span>                ).<span style="color:#50fa7b">get</span>();
</span></span><span style="display:flex;"><span>                fail(<span style="color:#ff79c6">&amp;</span>#34;we should never get here<span style="color:#ff79c6">!&amp;</span>#34;);
</span></span><span style="display:flex;"><span>            } <span style="color:#ff79c6">catch</span> (HttpServerErrorException e) {
</span></span><span style="display:flex;"><span>                <span style="color:#6272a4">// expected</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// circuit is now tripped</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>            callingEndpointCircuitBreaker.<span style="color:#50fa7b">decorateSupplier</span>(() <span style="color:#ff79c6">-&amp;</span>gt;
</span></span><span style="display:flex;"><span>                    restTemplate.<span style="color:#50fa7b">getForEntity</span>(<span style="color:#ff79c6">&amp;</span>#34;<span style="color:#ff79c6">/</span>some<span style="color:#ff79c6">/</span>endpoint<span style="color:#ff79c6">/</span>10<span style="color:#ff79c6">&amp;</span>#34;, JsonNode.<span style="color:#50fa7b">class</span>)
</span></span><span style="display:flex;"><span>            ).<span style="color:#50fa7b">get</span>();
</span></span><span style="display:flex;"><span>            fail(<span style="color:#ff79c6">&amp;</span>#34;we should never get here<span style="color:#ff79c6">!&amp;</span>#34;);
</span></span><span style="display:flex;"><span>        } <span style="color:#ff79c6">catch</span> (CallNotPermittedException callNotPermittedException)  {
</span></span><span style="display:flex;"><span>            assertEquals(<span style="color:#ff79c6">&amp;</span>#34;call<span style="color:#ff79c6">-</span>endpoint<span style="color:#ff79c6">&amp;</span>#34;, callNotPermittedException.<span style="color:#50fa7b">getCausingCircuitBreakerName</span>());
</span></span><span style="display:flex;"><span>            assertSame(CircuitBreaker.<span style="color:#50fa7b">State</span>.<span style="color:#50fa7b">OPEN</span>, callingEndpointCircuitBreaker.<span style="color:#50fa7b">getState</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>And with that, you should be good to go.</p>
</section>

  
    
  

    
  


  <footer>
    
      <div class="pb-14 taxonomy-list tags-list">
      
        <a href="/tags/java/" alt="Java">
          Java
        </a>
      
        <a href="/tags/spring/" alt="Spring">
          Spring
        </a>
      
        <a href="/tags/resilience/" alt="Resilience">
          Resilience
        </a>
      
      </div>
    
  </footer>
</article>


    </main><footer class="pt-5 pb-10 grid gap-3 sm:grid-cols-2">
    <div class="text-xs font-semibold text-gray-500 order-2 sm:order-1">
  © 2018-2025 —
  <a href="http://localhost:1313/">Nick Fisher&#39;s tech blog</a> 
</div>

    <div class="order-1 sm:order-2">
  <ul class="flex sm:justify-end gap-5">
    
    
    <li>    
      <a href="https://www.linkedin.com/in/nick-fisher-software/" target="_blank" rel="noopener noreferrer">LinkedIn</a>
    </li>
    
    <li>    
      <a href="https://github.com/nfisher23" target="_blank" rel="noopener noreferrer">GitHub</a>
    </li>
    
    
  </ul>
</div>

</footer></body>
</html>
