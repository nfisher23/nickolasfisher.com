<!DOCTYPE html>
<html lang="en-US" class="scroll-smooth dark">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>

<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>How to Dynamically Deserialize JSON In Java With Jackson</title>
<meta
  name="description"
  content="You can find the sample code associated with this blog post on GitHub.
Jackson is a data processor in Java, known particularly well for its ability to deal with JSON payloads."
/>
<link rel="canonical" href="http://localhost:1313/blog/how-to-dynamically-deserialize-json-in-java-with-jackson/" />
<link rel="robots" href="/robots.txt" />

<link rel="icon" type="image/x-icon" href="/icons/favicon.ico" />



<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script>

<link rel="stylesheet" href="http://localhost:1313/css/app.css" /></head>

  <body class="max-w-screen-md mx-auto px-2.5">
    <div class="header">
      <header class="flex flex-col sm:flex-row items-center gap-5 sm:gap-10 pt-16 py-12">
   


<div class="flex-none w-20 h-20 rounded-full overflow-hidden">
  <a href="http://localhost:1313/">
    <img
      srcset="/img/profile-picture_hu4241499301404582006.jpg 80w"
      src="/img/profile-picture.jpg"
      width="386"
      height="345"
      alt="Nick Fisher&#39;s tech blog"
    />
  </a>
</div>

  
  <div class="flex flex-col gap-5">
    <a href="http://localhost:1313/">
  <h1 id="site-title">Nick Fisher&#39;s tech blog</h1>
</a>
 
    <nav>
  <ul>
     
    
    <li>
      <a href="/" class="">
        Home
      </a>
    </li>
    
    <li>
      <a href="/blog" class="">
        Blog
      </a>
    </li>
    
    <li>
      <a href="/about" class="">
        About me
      </a>
    </li>
    
    <li>
      <a href="/categories" class="">
        Categories
      </a>
    </li>
    
    <li>
      <a href="/tags" class="">
        Tags
      </a>
    </li>
    
  </ul>
</nav>

  </div>
</header>

      <button class="toggle-theme" aria-label="Toggle Theme" title="Toggle Theme" onclick="toggleTheme()">
  <span class="theme-icon light"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
</svg> </span>
  <span class="theme-icon dark"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" />
</svg> </span>
</button>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const theme = localStorage.getItem('theme');

    if (!theme || theme === 'light') {
      setTheme('light');
    } else {
      setTheme(theme);
    }
  });

  function setTheme(theme) {
    const html = document.querySelector('html');
    localStorage.setItem('theme', theme);

    if (theme === 'light') {
      if (html.classList.contains('dark')) {
        document.querySelector('html').classList.remove('dark');
      }

      document.querySelector('.theme-icon.light').style.display = 'none';
      document.querySelector('.theme-icon.dark').style.display = 'block';
    } else {
      if (!html.classList.contains('dark')) {
        document.querySelector('html').classList.add('dark');
      }

      document.querySelector('.theme-icon.dark').style.display = 'none';
      document.querySelector('.theme-icon.light').style.display = 'block';
    }
  }

  function toggleTheme() {
    const theme = localStorage.getItem('theme');

    if (theme === 'light') {
      setTheme('dark');
    } else {
      setTheme('light');
    }
  }
</script>
    </div>
  
    <main id="content">

<article class="flex flex-col gap-10">
  <header class="flex flex-col gap-2">
    <h2 class="title-large">How to Dynamically Deserialize JSON In Java With Jackson</h2>

    <div class="meta">
      
      <time datetime="2018-11-01 00:00:00 &#43;0000 UTC" title='Thu, Nov 1, 2018, 12:00 AM UTC'>
        01/11/2018 - Estimated reading time: 5 minutes
      </time>

       
      
    </div>
  </header>

  

  <section><p>You can find the sample code associated with this blog post <a href="https://github.com/nfisher23/json-with-jackson-tricks">on GitHub</a>.</p>
<p><a href="https://github.com/FasterXML/jackson">Jackson</a> is a data processor in Java, known particularly well for its ability to deal with JSON payloads.</p>
<p>Java is a statically typed language, whose types must be known at compile time. Conversely, dynamically typed languages are the wild wild west&ndash;we can, and often do, decide to let any variable be whatever it wants to be at runtime. This is the inherent problem between JSON and Java&ndash;JavaScript is dynamic, Java is static. So, when we get a JSON payload like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    &amp;#34;hasErrors&amp;#34;: false,
</span></span><span style="display:flex;"><span>    &amp;#34;body&amp;#34;: {
</span></span><span style="display:flex;"><span>        &amp;#34;property1&amp;#34;: &amp;#34;value1&amp;#34;,
</span></span><span style="display:flex;"><span>        &amp;#34;property2&amp;#34;: &amp;#34;value2&amp;#34;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>We can make a POJO to deserialize pretty easily, like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">ResponseObject</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @JsonProperty(<span style="color:#ff79c6">&amp;</span>#34;hasErrors<span style="color:#ff79c6">&amp;</span>#34;)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">boolean</span> hasErrors;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @JsonProperty(<span style="color:#ff79c6">&amp;</span>#34;body<span style="color:#ff79c6">&amp;</span>#34;)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> SimpleObject body;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>... in a different file ...
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">SimpleObject</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @JsonProperty(<span style="color:#ff79c6">&amp;</span>#34;property1<span style="color:#ff79c6">&amp;</span>#34;)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> String property1;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @JsonProperty(<span style="color:#ff79c6">&amp;</span>#34;property2<span style="color:#ff79c6">&amp;</span>#34;)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> String property2;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> String <span style="color:#50fa7b">getProperty1</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> property1;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> String <span style="color:#50fa7b">getProperty2</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> property2;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And this will deserialize with a call to ObjectMapper.readValue(json, ResponseObject.class).</p>
<p>However, what if the same service also has a response like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    &amp;#34;hasErrors&amp;#34;: true,
</span></span><span style="display:flex;"><span>    &amp;#34;body&amp;#34;: [
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            &amp;#34;errorMessage&amp;#34;: &amp;#34;you totally messed this up&amp;#34;
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        {
</span></span><span style="display:flex;"><span>            &amp;#34;errorMessage&amp;#34;: &amp;#34;seriously, that was pretty whack&amp;#34;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In Java, since we have defined the body to be an object, trying to deserialize into the previously defined objects above will blow everything up. This would be easy to take care of in JavaScript or another dynamic language like Python, but Java requires us to get a little creative. In this very specific case, we could technically create another object and wrap each deserialization attempt in a try/catch block. However, sometimes we get back an array of objects, where each object could be either of the responses shown above, and then we have to put our spectacles on and figure something else out.</p>
<p>Jackson defaults to defining each node in the JSON object structure as a JsonNode. So, if we want to be able to handle multiple types of bodies (both arrays and objects, for example), we can simply defer the deserialization into a Java class until after we've had a chance to process it. We can then define another POJO as:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">DynamicResponseObject</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @JsonProperty(<span style="color:#ff79c6">&amp;</span>#34;hasErrors<span style="color:#ff79c6">&amp;</span>#34;)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">boolean</span> hasErrors;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @JsonIgnore
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> JsonNode bodyAsNode;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @JsonProperty(<span style="color:#ff79c6">&amp;</span>#34;body<span style="color:#ff79c6">&amp;</span>#34;)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">setBody</span>(JsonNode body) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">this</span>.<span style="color:#50fa7b">bodyAsNode</span> <span style="color:#ff79c6">=</span> body;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> JsonNode <span style="color:#50fa7b">getBodyAsNode</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">this</span>.<span style="color:#50fa7b">bodyAsNode</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And we can access the actual properties of our node underneath with a myriad of <a href="https://fasterxml.github.io/jackson-databind/javadoc/2.7/com/fasterxml/jackson/databind/JsonNode.html">methods for JsonNode</a>. For example, if we want to see whether the body is an array or object, we can call isArray() or isObject():</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@RunWith(SpringRunner.<span style="color:#50fa7b">class</span>)
</span></span><span style="display:flex;"><span>@SpringBootTest
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">DynamicDeserializationApplicationTests</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Autowired
</span></span><span style="display:flex;"><span>    ObjectMapper objectMapper;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd;font-style:italic">final</span> String NORMAL_RESPONSE <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">&amp;</span>#34;{\<span style="color:#ff79c6">&amp;</span>#34;hasErrors\<span style="color:#ff79c6">&amp;</span>#34;:<span style="color:#ff79c6">false</span>,\<span style="color:#ff79c6">&amp;</span>#34;body\<span style="color:#ff79c6">&amp;</span>#34;:{\<span style="color:#ff79c6">&amp;</span>#34;property1\<span style="color:#ff79c6">&amp;</span>#34;:\<span style="color:#ff79c6">&amp;</span>#34;value1\<span style="color:#ff79c6">&amp;</span>#34;,\<span style="color:#ff79c6">&amp;</span>#34;property2\<span style="color:#ff79c6">&amp;</span>#34;:\<span style="color:#ff79c6">&amp;</span>#34;value2\<span style="color:#ff79c6">&amp;</span>#34;}}<span style="color:#ff79c6">&amp;</span>#34;;
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd;font-style:italic">final</span> String RESPONSE_WITH_ERRORS <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">&amp;</span>#34;{\<span style="color:#ff79c6">&amp;</span>#34;hasErrors\<span style="color:#ff79c6">&amp;</span>#34;:<span style="color:#ff79c6">true</span>,\<span style="color:#ff79c6">&amp;</span>#34;body\<span style="color:#ff79c6">&amp;</span>#34;:<span style="color:#ff79c6">[</span>{\<span style="color:#ff79c6">&amp;</span>#34;errorMessage\<span style="color:#ff79c6">&amp;</span>#34;:\<span style="color:#ff79c6">&amp;</span>#34;you totally messed <span style="color:#ff79c6">this</span> up\<span style="color:#ff79c6">&amp;</span>#34;},{\<span style="color:#ff79c6">&amp;</span>#34;errorMessage\<span style="color:#ff79c6">&amp;</span>#34;:\<span style="color:#ff79c6">&amp;</span>#34;seriously, that was pretty whack\<span style="color:#ff79c6">&amp;</span>#34;}<span style="color:#ff79c6">]</span>}<span style="color:#ff79c6">&amp;</span>#34;;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Test
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">normalResponse_setsBodyIsObject</span>() <span style="color:#8be9fd;font-style:italic">throws</span> Exception {
</span></span><span style="display:flex;"><span>        DynamicResponseObject dynamicResponseObject <span style="color:#ff79c6">=</span> objectMapper.<span style="color:#50fa7b">readValue</span>(NORMAL_RESPONSE, DynamicResponseObject.<span style="color:#50fa7b">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        assertTrue(dynamicResponseObject.<span style="color:#50fa7b">getBodyAsNode</span>().<span style="color:#50fa7b">isObject</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Test
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">abnormalResponse_setsBodyIsArray</span>() <span style="color:#8be9fd;font-style:italic">throws</span> Exception {
</span></span><span style="display:flex;"><span>        DynamicResponseObject dynamicResponseObject <span style="color:#ff79c6">=</span> objectMapper.<span style="color:#50fa7b">readValue</span>(RESPONSE_WITH_ERRORS, DynamicResponseObject.<span style="color:#50fa7b">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        assertTrue(dynamicResponseObject.<span style="color:#50fa7b">getBodyAsNode</span>().<span style="color:#50fa7b">isArray</span>());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>If we want to see the properties of something we know is an object, we can call get(..) and transform it into whatever we think the type is (here using asText() to get it as a String):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    @Test
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">normalResponse_accessNodeDynamically</span>() <span style="color:#8be9fd;font-style:italic">throws</span> Exception {
</span></span><span style="display:flex;"><span>        DynamicResponseObject dynamicResponseObject <span style="color:#ff79c6">=</span> objectMapper.<span style="color:#50fa7b">readValue</span>(NORMAL_RESPONSE, DynamicResponseObject.<span style="color:#50fa7b">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        JsonNode bodyNode <span style="color:#ff79c6">=</span> dynamicResponseObject.<span style="color:#50fa7b">getBodyAsNode</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        assertEquals(<span style="color:#ff79c6">&amp;</span>#34;value1<span style="color:#ff79c6">&amp;</span>#34;, bodyNode.<span style="color:#50fa7b">get</span>(<span style="color:#ff79c6">&amp;</span>#34;property1<span style="color:#ff79c6">&amp;</span>#34;).<span style="color:#50fa7b">asText</span>());
</span></span><span style="display:flex;"><span>        assertEquals(<span style="color:#ff79c6">&amp;</span>#34;value2<span style="color:#ff79c6">&amp;</span>#34;, bodyNode.<span style="color:#50fa7b">get</span>(<span style="color:#ff79c6">&amp;</span>#34;property2<span style="color:#ff79c6">&amp;</span>#34;).<span style="color:#50fa7b">asText</span>());
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>We can see the array properties by using get(..) with an int argument:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    @Test
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">abnormalResponse_accessNodesDynamically</span>() <span style="color:#8be9fd;font-style:italic">throws</span> Exception {
</span></span><span style="display:flex;"><span>        DynamicResponseObject dynamicResponseObject <span style="color:#ff79c6">=</span> objectMapper.<span style="color:#50fa7b">readValue</span>(RESPONSE_WITH_ERRORS, DynamicResponseObject.<span style="color:#50fa7b">class</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        JsonNode bodyNode <span style="color:#ff79c6">=</span> dynamicResponseObject.<span style="color:#50fa7b">getBodyAsNode</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        assertEquals(<span style="color:#ff79c6">&amp;</span>#34;you totally messed <span style="color:#ff79c6">this</span> up<span style="color:#ff79c6">&amp;</span>#34;, bodyNode.<span style="color:#50fa7b">get</span>(0).<span style="color:#50fa7b">get</span>(<span style="color:#ff79c6">&amp;</span>#34;errorMessage<span style="color:#ff79c6">&amp;</span>#34;).<span style="color:#50fa7b">asText</span>());
</span></span><span style="display:flex;"><span>        assertEquals(<span style="color:#ff79c6">&amp;</span>#34;seriously, that was pretty whack<span style="color:#ff79c6">&amp;</span>#34;, bodyNode.<span style="color:#50fa7b">get</span>(1).<span style="color:#50fa7b">get</span>(<span style="color:#ff79c6">&amp;</span>#34;errorMessage<span style="color:#ff79c6">&amp;</span>#34;).<span style="color:#50fa7b">asText</span>());
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Now, if we want to take it a step further and deserialize into a Java object, which has the obvious advantage of being compile-time safe (provided it deserializes correctly from the API) and providing Intellisense to developers, we will have to get a little creative. We can use an ObjectMapper to deserialize the node as a String like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    @JsonIgnore
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> SimpleObject simpleObject;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> SimpleObject <span style="color:#50fa7b">getBodyAsSimpleObject</span>() <span style="color:#8be9fd;font-style:italic">throws</span> IOException {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (simpleObject <span style="color:#ff79c6">==</span> <span style="color:#ff79c6">null</span>) {
</span></span><span style="display:flex;"><span>            setSimpleObject();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> simpleObject;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">setSimpleObject</span>() <span style="color:#8be9fd;font-style:italic">throws</span> IOException {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (bodyAsNode.<span style="color:#50fa7b">isObject</span>()) {
</span></span><span style="display:flex;"><span>            simpleObject <span style="color:#ff79c6">=</span> objectMapper.<span style="color:#50fa7b">readValue</span>(bodyAsNode.<span style="color:#50fa7b">toString</span>(), SimpleObject.<span style="color:#50fa7b">class</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>            simpleObject <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> SimpleObject();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>And we can similarly define an error class:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">Error</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @JsonProperty(<span style="color:#ff79c6">&amp;</span>#34;errorMessage<span style="color:#ff79c6">&amp;</span>#34;)
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> String errorMessage;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> String <span style="color:#50fa7b">getErrorMessage</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> errorMessage;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And then deserialize it like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    @JsonIgnore
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> List<span style="color:#ff79c6">&amp;</span>lt;Error<span style="color:#ff79c6">&amp;</span>gt; errors;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> List<span style="color:#ff79c6">&amp;</span>lt;Error<span style="color:#ff79c6">&amp;</span>gt; getErrors() <span style="color:#8be9fd;font-style:italic">throws</span> IOException {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (errors <span style="color:#ff79c6">==</span> <span style="color:#ff79c6">null</span>) {
</span></span><span style="display:flex;"><span>            setErrors();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> errors;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">setErrors</span>() <span style="color:#8be9fd;font-style:italic">throws</span> IOException {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (bodyAsNode.<span style="color:#50fa7b">isArray</span>()) {
</span></span><span style="display:flex;"><span>            TypeFactory typeFactory <span style="color:#ff79c6">=</span> objectMapper.<span style="color:#50fa7b">getTypeFactory</span>();
</span></span><span style="display:flex;"><span>            JavaType javaType <span style="color:#ff79c6">=</span> typeFactory.<span style="color:#50fa7b">constructParametricType</span>(List.<span style="color:#50fa7b">class</span>, Error.<span style="color:#50fa7b">class</span>);
</span></span><span style="display:flex;"><span>            errors <span style="color:#ff79c6">=</span> objectMapper.<span style="color:#50fa7b">readValue</span>(bodyAsNode.<span style="color:#50fa7b">toString</span>(), javaType);
</span></span><span style="display:flex;"><span>        } <span style="color:#ff79c6">else</span> {
</span></span><span style="display:flex;"><span>            errors <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ArrayList<span style="color:#ff79c6">&amp;</span>lt;<span style="color:#ff79c6">&amp;</span>gt;();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Keep in mind that we can't inject an ObjectMapper into this POJO class because it gets deserialized, and not created by a DI framework (like, for example, Spring). It would be smart to not instantiate a new ObjectMapper in the class itself, since the benefits of dependency injection are pretty obvious at this point. If you are using Spring, you can ask for a previously defined ObjectMapper by leveraging the ApplicationContext. Create an ApplicationContextProvider like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>@Component
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">ApplicationContextProvider</span> <span style="color:#8be9fd;font-style:italic">implements</span> ApplicationContextAware {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd;font-style:italic">static</span> ApplicationContext applicationContext;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> ApplicationContext <span style="color:#50fa7b">getApplicationContext</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> applicationContext;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">setApplicationContext</span>(ApplicationContext appContext) <span style="color:#8be9fd;font-style:italic">throws</span> BeansException {
</span></span><span style="display:flex;"><span>        applicationContext <span style="color:#ff79c6">=</span> appContext;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And then get a bit of a hacked DI result by calling it inside your POJO:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    @JsonIgnore
</span></span><span style="display:flex;"><span>    ObjectMapper objectMapper <span style="color:#ff79c6">=</span> ApplicationContextProvider.<span style="color:#50fa7b">getApplicationContext</span>().<span style="color:#50fa7b">getBean</span>(ObjectMapper.<span style="color:#50fa7b">class</span>);
</span></span></code></pre></div><p>Which is still kind of ugly, but at least reduces the cost of instantiation duplication.</p>
<p>Definitely <a href="https://github.com/nfisher23/json-with-jackson-tricks">download the source code for this post</a> and play around with it if it's not clear to you.</p>
</section>

  
    
  

    
  


  <footer>
    
  </footer>
</article>


    </main><footer class="pt-5 pb-10 grid gap-3 sm:grid-cols-2">
    <div class="text-xs font-semibold text-gray-500 order-2 sm:order-1">
  © 2018-2025 —
  <a href="http://localhost:1313/">Nick Fisher&#39;s tech blog</a> 
</div>

    <div class="order-1 sm:order-2">
  <ul class="flex sm:justify-end gap-5">
    
    
    <li>    
      <a href="https://www.linkedin.com/in/nick-fisher-software/" target="_blank" rel="noopener noreferrer">LinkedIn</a>
    </li>
    
    <li>    
      <a href="https://github.com/nfisher23" target="_blank" rel="noopener noreferrer">GitHub</a>
    </li>
    
    
  </ul>
</div>

</footer></body>
</html>
