<!DOCTYPE html>
<html lang="en-US" class="scroll-smooth dark">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>

<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>The Java Stream API: Generating Fibonacci Numbers</title>
<meta
  name="description"
  content="You can find the sample code for this post on GitHub.
From the knowledge gained via creating custom Java Stream objects, we can start
to have a little bit of fun with this. The fibonacci number sequence starts with [0, 1], and adds each of the previous two elements to create the next element in the sequence.
This looks like [0, 1, 1, 2, 3, 5, 8, 13, 21&hellip;], and goes on &quot;forever.&quot; We can thus create a template that computes all Fibonacci numbers by implementing a Supplier&lt;T&gt;. like so:"
/>
<link rel="canonical" href="http://localhost:1313/blog/the-java-stream-api-generating-fibonacci-numbers/" />
<link rel="robots" href="/robots.txt" />

<link rel="icon" type="image/x-icon" href="/icons/favicon.ico" />



<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script>

<link rel="stylesheet" href="http://localhost:1313/css/app.css" /></head>

  <body class="max-w-screen-md mx-auto px-2.5">
    <div class="header">
      <header class="flex flex-col sm:flex-row items-center gap-5 sm:gap-10 pt-16 py-12">
   


<div class="flex-none w-20 h-20 rounded-full overflow-hidden">
  <a href="http://localhost:1313/">
    <img
      srcset="/img/profile-picture_hu4241499301404582006.jpg 80w"
      src="/img/profile-picture.jpg"
      width="386"
      height="345"
      alt="Nick Fisher&#39;s tech blog"
    />
  </a>
</div>

  
  <div class="flex flex-col gap-5">
    <a href="http://localhost:1313/">
  <h1 id="site-title">Nick Fisher&#39;s tech blog</h1>
</a>
 
    <nav>
  <ul>
     
    
    <li>
      <a href="/" class="">
        Home
      </a>
    </li>
    
    <li>
      <a href="/blog" class="">
        Blog
      </a>
    </li>
    
    <li>
      <a href="/about" class="">
        About me
      </a>
    </li>
    
    <li>
      <a href="/categories" class="">
        Categories
      </a>
    </li>
    
    <li>
      <a href="/tags" class="">
        Tags
      </a>
    </li>
    
  </ul>
</nav>

  </div>
</header>

      <button class="toggle-theme" aria-label="Toggle Theme" title="Toggle Theme" onclick="toggleTheme()">
  <span class="theme-icon light"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
</svg> </span>
  <span class="theme-icon dark"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" />
</svg> </span>
</button>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const theme = localStorage.getItem('theme');

    if (!theme || theme === 'light') {
      setTheme('light');
    } else {
      setTheme(theme);
    }
  });

  function setTheme(theme) {
    const html = document.querySelector('html');
    localStorage.setItem('theme', theme);

    if (theme === 'light') {
      if (html.classList.contains('dark')) {
        document.querySelector('html').classList.remove('dark');
      }

      document.querySelector('.theme-icon.light').style.display = 'none';
      document.querySelector('.theme-icon.dark').style.display = 'block';
    } else {
      if (!html.classList.contains('dark')) {
        document.querySelector('html').classList.add('dark');
      }

      document.querySelector('.theme-icon.dark').style.display = 'none';
      document.querySelector('.theme-icon.light').style.display = 'block';
    }
  }

  function toggleTheme() {
    const theme = localStorage.getItem('theme');

    if (theme === 'light') {
      setTheme('dark');
    } else {
      setTheme('light');
    }
  }
</script>
    </div>
  
    <main id="content">

<article class="flex flex-col gap-10">
  <header class="flex flex-col gap-2">
    <h2 class="title-large">The Java Stream API: Generating Fibonacci Numbers</h2>

    <div class="meta">
      
      <time datetime="2018-10-01 00:00:00 &#43;0000 UTC" title='Mon, Oct 1, 2018, 12:00 AM UTC'>
        01/10/2018 - Estimated reading time: 2 minutes
      </time>

       
      
    </div>
  </header>

  

  <section><p>You can find the sample code for this post <a href="https://github.com/nfisher23/java_stream_api_samples">on GitHub</a>.</p>
<p>From the knowledge gained via <a href="https://nickolasfisher.com/blog/The-Java-Stream-API-Creating-Custom-Lazy-Infinite-Streams">creating custom Java Stream objects</a>, we can start
to have a little bit of fun with this. The fibonacci number sequence starts with [0, 1], and adds each of the previous two elements to create the next element in the sequence.
This looks like [0, 1, 1, 2, 3, 5, 8, 13, 21&hellip;], and goes on &quot;forever.&quot; We can thus create a template that computes all Fibonacci numbers by implementing a Supplier&lt;T&gt;. like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.function.Supplier;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">SupplyFibonacci</span> <span style="color:#8be9fd;font-style:italic">implements</span> Supplier<span style="color:#ff79c6">&amp;</span>lt;Integer<span style="color:#ff79c6">&amp;</span>gt; {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">int</span><span style="color:#ff79c6">[]</span> lastTwoFibs <span style="color:#ff79c6">=</span> {0, 1};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">boolean</span> returnedFirstFib;
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd">boolean</span> returnedSecondFib;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    @Override
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> Integer <span style="color:#50fa7b">get</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (<span style="color:#ff79c6">!</span>returnedFirstFib) {
</span></span><span style="display:flex;"><span>            returnedFirstFib <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">true</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> 0;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (<span style="color:#ff79c6">!</span>returnedSecondFib) {
</span></span><span style="display:flex;"><span>            returnedSecondFib <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">true</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span> 1;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#8be9fd">int</span> nextFib <span style="color:#ff79c6">=</span> lastTwoFibs<span style="color:#ff79c6">[</span>0<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">&amp;</span>#43; lastTwoFibs<span style="color:#ff79c6">[</span>1<span style="color:#ff79c6">]</span>;
</span></span><span style="display:flex;"><span>        lastTwoFibs<span style="color:#ff79c6">[</span>0<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">=</span> lastTwoFibs<span style="color:#ff79c6">[</span>1<span style="color:#ff79c6">]</span>;
</span></span><span style="display:flex;"><span>        lastTwoFibs<span style="color:#ff79c6">[</span>1<span style="color:#ff79c6">]</span> <span style="color:#ff79c6">=</span> nextFib;
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> nextFib;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Which we can validate like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    @Test
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">validate_fibonacci</span>() {
</span></span><span style="display:flex;"><span>        List<span style="color:#ff79c6">&amp;</span>lt;Integer<span style="color:#ff79c6">&amp;</span>gt; tenFibs <span style="color:#ff79c6">=</span> Stream.<span style="color:#50fa7b">generate</span>(<span style="color:#ff79c6">new</span> SupplyFibonacci()).<span style="color:#50fa7b">limit</span>(10).<span style="color:#50fa7b">collect</span>(Collectors.<span style="color:#50fa7b">toList</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        assertEquals(0,tenFibs.<span style="color:#50fa7b">get</span>(0).<span style="color:#50fa7b">intValue</span>());
</span></span><span style="display:flex;"><span>        assertEquals(1,tenFibs.<span style="color:#50fa7b">get</span>(1).<span style="color:#50fa7b">intValue</span>());
</span></span><span style="display:flex;"><span>        assertEquals(1,tenFibs.<span style="color:#50fa7b">get</span>(2).<span style="color:#50fa7b">intValue</span>());
</span></span><span style="display:flex;"><span>        assertEquals(2,tenFibs.<span style="color:#50fa7b">get</span>(3).<span style="color:#50fa7b">intValue</span>());
</span></span><span style="display:flex;"><span>        assertEquals(3,tenFibs.<span style="color:#50fa7b">get</span>(4).<span style="color:#50fa7b">intValue</span>());
</span></span><span style="display:flex;"><span>        assertEquals(5,tenFibs.<span style="color:#50fa7b">get</span>(5).<span style="color:#50fa7b">intValue</span>());
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>And we can use that sequence to get any Fibonacci number we want, bounded by the laws of physics and bits. In this case, things start to get wonky around Fibonacci ~50 or so, due to machine precision breaking down:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    @Test
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">fibonacciStream_printVals</span>() {
</span></span><span style="display:flex;"><span>        Stream.<span style="color:#50fa7b">generate</span>(<span style="color:#ff79c6">new</span> SupplyFibonacci()).<span style="color:#50fa7b">peek</span>(System.<span style="color:#50fa7b">out</span>::println).<span style="color:#50fa7b">limit</span>(25).<span style="color:#50fa7b">collect</span>(Collectors.<span style="color:#50fa7b">toList</span>());
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div></section>

  
    
  

    
  


  <footer>
    
  </footer>
</article>


    </main><footer class="pt-5 pb-10 grid gap-3 sm:grid-cols-2">
    <div class="text-xs font-semibold text-gray-500 order-2 sm:order-1">
  © 2018-2025 —
  <a href="http://localhost:1313/">Nick Fisher&#39;s tech blog</a> 
</div>

    <div class="order-1 sm:order-2">
  <ul class="flex sm:justify-end gap-5">
    
    
    <li>    
      <a href="https://www.linkedin.com/in/nick-fisher-software/" target="_blank" rel="noopener noreferrer">LinkedIn</a>
    </li>
    
    <li>    
      <a href="https://github.com/nfisher23" target="_blank" rel="noopener noreferrer">GitHub</a>
    </li>
    
    
  </ul>
</div>

</footer></body>
</html>
