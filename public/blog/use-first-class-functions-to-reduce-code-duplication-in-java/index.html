<!DOCTYPE html>
<html lang="en-US" class="scroll-smooth dark">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>

<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Use First Class Functions to Reduce Code Duplication In Java</title>
<meta
  name="description"
  content="Often when we program, we find ourselves creating patterns, usually in the form of boilerplate code, that seem to always do the same thing. For example, let&#39;s say you have some logging logic that is non-trivial, and you want to make extra sure you don&#39;t blow up your main application while it&#39;s running, so you surround it with a try/catch block:"
/>
<link rel="canonical" href="http://localhost:1313/blog/use-first-class-functions-to-reduce-code-duplication-in-java/" />
<link rel="robots" href="/robots.txt" />

<link rel="icon" type="image/x-icon" href="/icons/favicon.ico" />



<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script>

<link rel="stylesheet" href="http://localhost:1313/css/app.css" /></head>

  <body class="max-w-screen-md mx-auto px-2.5">
    <div class="header">
      <header class="flex flex-col sm:flex-row items-center gap-5 sm:gap-10 pt-16 py-12">
   


<div class="flex-none w-20 h-20 rounded-full overflow-hidden">
  <a href="http://localhost:1313/">
    <img
      srcset="/img/profile-picture_hu4241499301404582006.jpg 80w"
      src="/img/profile-picture.jpg"
      width="386"
      height="345"
      alt="Nick Fisher&#39;s tech blog"
    />
  </a>
</div>

  
  <div class="flex flex-col gap-5">
    <a href="http://localhost:1313/">
  <h1 id="site-title">Nick Fisher&#39;s tech blog</h1>
</a>
 
    <nav>
  <ul>
     
    
    <li>
      <a href="/" class="">
        Home
      </a>
    </li>
    
    <li>
      <a href="/blog" class="">
        Blog
      </a>
    </li>
    
    <li>
      <a href="/about" class="">
        About me
      </a>
    </li>
    
    <li>
      <a href="/categories" class="">
        Categories
      </a>
    </li>
    
    <li>
      <a href="/tags" class="">
        Tags
      </a>
    </li>
    
  </ul>
</nav>

  </div>
</header>

      <button class="toggle-theme" aria-label="Toggle Theme" title="Toggle Theme" onclick="toggleTheme()">
  <span class="theme-icon light"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386l-1.591 1.591M21 12h-2.25m-.386 6.364l-1.591-1.591M12 18.75V21m-4.773-4.227l-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0z" />
</svg> </span>
  <span class="theme-icon dark"> <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.718 9.718 0 0118 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 003 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 009.002-5.998z" />
</svg> </span>
</button>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const theme = localStorage.getItem('theme');

    if (!theme || theme === 'light') {
      setTheme('light');
    } else {
      setTheme(theme);
    }
  });

  function setTheme(theme) {
    const html = document.querySelector('html');
    localStorage.setItem('theme', theme);

    if (theme === 'light') {
      if (html.classList.contains('dark')) {
        document.querySelector('html').classList.remove('dark');
      }

      document.querySelector('.theme-icon.light').style.display = 'none';
      document.querySelector('.theme-icon.dark').style.display = 'block';
    } else {
      if (!html.classList.contains('dark')) {
        document.querySelector('html').classList.add('dark');
      }

      document.querySelector('.theme-icon.dark').style.display = 'none';
      document.querySelector('.theme-icon.light').style.display = 'block';
    }
  }

  function toggleTheme() {
    const theme = localStorage.getItem('theme');

    if (theme === 'light') {
      setTheme('dark');
    } else {
      setTheme('light');
    }
  }
</script>
    </div>
  
    <main id="content">

<article class="flex flex-col gap-10">
  <header class="flex flex-col gap-2">
    <h2 class="title-large">Use First Class Functions to Reduce Code Duplication In Java</h2>

    <div class="meta">
      
      <time datetime="2018-11-24 19:03:21 &#43;0000 UTC" title='Sat, Nov 24, 2018, 7:03 PM UTC'>
        24/11/2018 - Estimated reading time: 4 minutes
      </time>

       
      
    </div>
  </header>

  

  <section><p>Often when we program, we find ourselves creating patterns, usually in the form of boilerplate code, that seem to always do the same thing. For example, let's say you have some logging logic that is non-trivial, and you want to make extra sure you don't blow up your main application while it's running, so you surround it with a try/catch block:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">logSomething</span>(List<span style="color:#ff79c6">&amp;</span>lt;String<span style="color:#ff79c6">&amp;</span>gt; stuffToLog) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>            log.<span style="color:#50fa7b">info</span>(<span style="color:#ff79c6">&amp;</span>#34;stuff: <span style="color:#ff79c6">&amp;</span>#34; <span style="color:#ff79c6">&amp;</span>#43; String.<span style="color:#50fa7b">join</span>(<span style="color:#ff79c6">&amp;</span>#34;,<span style="color:#ff79c6">&amp;</span>#34;, stuffToLog));
</span></span><span style="display:flex;"><span>        } <span style="color:#ff79c6">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            log.<span style="color:#50fa7b">error</span>(<span style="color:#ff79c6">&amp;</span>#34;failed to log: <span style="color:#ff79c6">&amp;</span>#34; <span style="color:#ff79c6">&amp;</span>#43; e.<span style="color:#50fa7b">toString</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Or maybe you just want to make sure that it's not null before you pass it in, so you validate that it's not null before loggging:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">logSomethingElse</span>(List<span style="color:#ff79c6">&amp;</span>lt;String<span style="color:#ff79c6">&amp;</span>gt; stuffToLog) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (stuffToLog <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">null</span> <span style="color:#ff79c6">&amp;</span>amp;<span style="color:#ff79c6">&amp;</span>amp; stuffToLog.<span style="color:#50fa7b">size</span>() <span style="color:#ff79c6">&amp;</span>gt; 0) {
</span></span><span style="display:flex;"><span>            log.<span style="color:#50fa7b">info</span>(<span style="color:#ff79c6">&amp;</span>#34;stuff: <span style="color:#ff79c6">&amp;</span>#34; <span style="color:#ff79c6">&amp;</span>#43; String.<span style="color:#50fa7b">join</span>(<span style="color:#ff79c6">&amp;</span>#34;,<span style="color:#ff79c6">&amp;</span>#34;, stuffToLog));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Let's say you have to do this a lot in your application. There are some pieces of business logic that, for the sake of being resilient, you want to surround in a try/catch and log any failures. You might write another method like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">executeSomething</span>(String value) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>            repository.<span style="color:#50fa7b">persist</span>(value);
</span></span><span style="display:flex;"><span>        } <span style="color:#ff79c6">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            log.<span style="color:#50fa7b">error</span>(<span style="color:#ff79c6">&amp;</span>#34;we failed to execute <span style="color:#ff79c6">this</span> code block: <span style="color:#ff79c6">&amp;</span>#34; <span style="color:#ff79c6">&amp;</span>#43; e.<span style="color:#50fa7b">toString</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>While it doesn't feel like it at first, <em>this is code duplication</em>, which is the root of all evil in non-trivial projects. When you, or some other programmer, later realizes that simply calling <strong>e.toString()</strong> doesn't give you enough information to adequately debug something (it's not), and you instead have to do some annoyingly fancy (thanks, Java) stuff to get the stack track to log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>StringWriter sw <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> StringWriter();
</span></span><span style="display:flex;"><span>PrintWriter pw <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> PrintWriter(sw);
</span></span><span style="display:flex;"><span>e.<span style="color:#50fa7b">printStackTrace</span>(pw);
</span></span><span style="display:flex;"><span>String actualStackTrace <span style="color:#ff79c6">=</span> sw.<span style="color:#50fa7b">toString</span>();
</span></span></code></pre></div><p>You now have to change the way you log exceptions everywhere in the application. You might say, &quot;well, that's an easy fix. Just refactor the <strong>log.info(..)</strong> method into it's own <strong>customLog(..)</strong> method, and call that throughout your application.&quot;</p>
<p>That choice takes you one step closer, but it will only solve one of the forms of code duplication that is present in this example. <em>Surrounding everything with a try/catch block is duplication</em>. Let's say there's a particular type of custom defined exception that permeates your code called a <strong>HolyCrudException</strong>. That gets added later on in development, but you have to ensure that previously developed code handles that specific exception:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">executeSomething</span>(String value) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>            repository.<span style="color:#50fa7b">persist</span>(value);
</span></span><span style="display:flex;"><span>        } <span style="color:#ff79c6">catch</span> (HolyCrudException e) {
</span></span><span style="display:flex;"><span>            customLogError(<span style="color:#ff79c6">&amp;</span>#34;HolyCrudException<span style="color:#ff79c6">!</span> This is seriously not good<span style="color:#ff79c6">!</span> Raising the alarms<span style="color:#ff79c6">&amp;</span>#34;);
</span></span><span style="display:flex;"><span>            raiseAlarm();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            customLogError(<span style="color:#ff79c6">&amp;</span>#34;we failed to execute <span style="color:#ff79c6">this</span> code block: <span style="color:#ff79c6">&amp;</span>#34; <span style="color:#ff79c6">&amp;</span>#43; getStackTrace(e));
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Well, now you have to go back to every try/catch block you've previously defined and change that too.</p>
<p>One very good solution to this problem in Java is taking full advantage of lamdbas to create <strong>templates</strong>, which leverages Java 8+ and its support for first-class functions. We can pass in a function like it's a variable, and the Java compiler silently makes an anonymous class for us under the hood. Templates are found extensively in the Spring libraries, notably <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/jdbc/core/JdbcTemplate.html">JdbcTemplate</a> and <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/client/RestTemplate.html">RestTemplate</a>. We can make our own templates easily by leveraging the extensive <a href="https://docs.oracle.com/javase/8/docs/api/java/util/function/package-summary.html">Java library for Functional Interfaces</a>. Here, we obviously want to run some method inside a try/catch block, and log certain types of exceptions, so we can create a method that takes a Runnable:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">runInsideTryCatch</span>(Runnable r) {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">try</span> {
</span></span><span style="display:flex;"><span>            r.<span style="color:#50fa7b">run</span>();
</span></span><span style="display:flex;"><span>        } <span style="color:#ff79c6">catch</span> (HolyCrudException e) {
</span></span><span style="display:flex;"><span>            log.<span style="color:#50fa7b">error</span>(<span style="color:#ff79c6">&amp;</span>#34;HolyCrudException<span style="color:#ff79c6">!</span> This is seriously not good<span style="color:#ff79c6">!</span> Raising the alarms<span style="color:#ff79c6">&amp;</span>#34;);
</span></span><span style="display:flex;"><span>            raiseAlarm();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">catch</span> (Exception e) {
</span></span><span style="display:flex;"><span>            log.<span style="color:#50fa7b">error</span>(<span style="color:#ff79c6">&amp;</span>#34;we failed to execute <span style="color:#ff79c6">this</span> code block: <span style="color:#ff79c6">&amp;</span>#34; <span style="color:#ff79c6">&amp;</span>#43; e.<span style="color:#50fa7b">toString</span>());
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>And we can reuse this method whenever we want with a simple lambda expression:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>runInsideTryCatch(() <span style="color:#ff79c6">-&amp;</span>gt; repository.<span style="color:#50fa7b">persist</span>(value));
</span></span></code></pre></div><p>And:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>runInsideTryCatch(() <span style="color:#ff79c6">-&amp;</span>gt; customLogError(<span style="color:#ff79c6">&amp;</span>#34;log something uber important<span style="color:#ff79c6">&amp;</span>#34;));
</span></span></code></pre></div><p>Another approach might be Aspect Oriented Programming, but the advantage of this approach is its transparency. AOP can often feel &quot;magical,&quot; since a code block might be affected by an AOP framework behind the scenes. This approach clearly lays out its intention, and you can navigate to the <strong>runInsideTryCatch(..)</strong> method with a shortcut on your IDE.</p>
<p>I personally find this method of templating, and leveraging the passing around of functions as normal variables, extremely useful. Focusing on the new logic you want to introduce, rather than constantly rewriting boilerplate code, can make everything in your application more changeable and less prone to nasty bugs. One mistake should require one fix, and if it doesn't it usually means you have an opportunity to improve your skills.</p>
</section>

  
    
  

    
  


  <footer>
    
  </footer>
</article>


    </main><footer class="pt-5 pb-10 grid gap-3 sm:grid-cols-2">
    <div class="text-xs font-semibold text-gray-500 order-2 sm:order-1">
  © 2018-2025 —
  <a href="http://localhost:1313/">Nick Fisher&#39;s tech blog</a> 
</div>

    <div class="order-1 sm:order-2">
  <ul class="flex sm:justify-end gap-5">
    
    
    <li>    
      <a href="https://www.linkedin.com/in/nick-fisher-software/" target="_blank" rel="noopener noreferrer">LinkedIn</a>
    </li>
    
    <li>    
      <a href="https://github.com/nfisher23" target="_blank" rel="noopener noreferrer">GitHub</a>
    </li>
    
    
  </ul>
</div>

</footer></body>
</html>
